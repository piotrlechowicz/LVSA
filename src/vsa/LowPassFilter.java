package vsa;

/*************************************************************************************
 * Klasa LowPassFilter
 * 
 * Klasa realizuj�ca filtr 800-nego rz�du o sko�czonej odpowidzi impulsowej.
 * Jest to filtr z oknem czasowym Blackmana o cz�tsotliwo�ci odci�cia 400 Hz.
 * 
 * *****************************************************************************
 * ******
 */
public class LowPassFilter {

	/**
	 * Wsp�czynniki filtru
	 */
	private static final double coeff[] = { 0, -3.09236906250145e-09, -1.16621413750432e-08, -2.45557542337669e-08,
			-4.05046645954493e-08, -5.81366964073535e-08, -7.59883029998755e-08, -9.25176799418175e-08,
			-1.06118658751313e-07, -1.15135307104001e-07, -1.17877156703393e-07, -1.12634975798380e-07,
			-9.76969994672016e-08, -7.13655272565302e-08, -3.19737945852341e-08, 2.20969784866114e-08,
			9.24004599459233e-08, 1.80408100815630e-07, 2.87492154892933e-07, 4.14908926860107e-07,
			5.63782353123439e-07, 7.35088020014686e-07, 9.29637723804598e-07, 1.14806467632067e-06,
			1.39080945882484e-06, 1.65810682518491e-06, 1.94997345326195e-06, 2.26619674083339e-06,
			2.60632473927529e-06, 2.96965731463963e-06, 3.35523862168689e-06, 3.76185097187243e-06,
			4.18801017124830e-06, 4.63196239873433e-06, 5.09168268924768e-06, 5.56487507976972e-06,
			6.04897446958912e-06, 6.54115023870543e-06, 7.03831166073072e-06, 7.53711513860731e-06,
			8.03397328309023e-06, 8.52506584525360e-06, 9.00635250529271e-06, 9.47358751064512e-06,
			9.92233614697004e-06, 1.03479930158466e-05, 1.07458020832089e-05, 1.11108784525704e-05,
			1.14382318070432e-05, 1.17227914540664e-05, 1.19594328966690e-05, 1.21430058450537e-05,
			1.22683635723364e-05, 1.23303935084684e-05, 1.23240489567487e-05, 1.22443818079481e-05,
			1.20865761179763e-05, 1.18459824062601e-05, 1.15181525236349e-05, 1.10988749306199e-05,
			1.05842102195066e-05, 9.97052670678619e-06, 9.25453591612900e-06, 8.43332776645153e-06,
			7.50440527460958e-06, 6.46571857799615e-06, 5.31569807882518e-06, 4.05328650920915e-06,
			2.67796971431396e-06, 1.18980594994375e-06, -4.10546509099106e-07, -2.12180365257879e-06,
			-3.94203211108448e-06, -5.86862782280389e-06, -7.89829718465892e-06, -1.00270408766353e-05,
			-1.22501405420550e-05, -1.45621484994031e-05, -1.69568806531068e-05, -1.94274127613892e-05,
			-2.19660802089826e-05, -2.45644814211058e-05, -2.72134850426913e-05, -2.99032409934363e-05,
			-3.26231954948451e-05, -3.53621101500907e-05, -3.81080851412770e-05, -4.08485865915686e-05,
			-4.35704781217382e-05, -4.62600566120110e-05, -4.89030921607121e-05, -5.14848722112379e-05,
			-5.39902497983187e-05, -5.64036958435200e-05, -5.87093554085028e-05, -6.08911077928367e-05,
			-6.29326303412047e-05, -6.48174658027601e-05, -6.65290930632939e-05, -6.80510010488354e-05,
			-6.93667655774572e-05, -7.04601289144841e-05, -7.13150817651340e-05, -7.19159474179411e-05,
			-7.22474677322617e-05, -7.22948906438355e-05, -7.20440588438895e-05, -7.14814992697408e-05,
			-7.05945130283952e-05, -6.93712653593427e-05, -6.78008752287559e-05, -6.58735041346801e-05,
			-6.35804436916823e-05, -6.09142015539089e-05, -5.78685852276504e-05, -5.44387833184556e-05,
			-5.06214437536365e-05, -4.64147485187423e-05, -4.18184844463319e-05, -3.68341095972090e-05,
			-3.14648147782411e-05, -2.57155797470351e-05, -1.95932236621213e-05, -1.31064493479167e-05,
			-6.26588095666994e-06, 9.15905375230231e-07, 8.42435826167659e-06, 1.62429355573125e-05,
			2.43530969473100e-05, 3.27343049554072e-05, 4.13640346626618e-05, 5.02177924007311e-05,
			5.92691436527458e-05, 6.84897503620943e-05, 7.78494178147670e-05, 8.73161512243955e-05,
			9.68562221108855e-05, 0.000106434244523717, 0.000116013261119668, 0.000125554839062057,
			0.000135019175664793, 0.000144365213659611, 0.000153550765919208, 0.000162532649422522,
			0.000171266828201537, 0.000179708564961776, 0.000187812581021308, 0.000195533224165903,
			0.000202824643971039, 0.000209640974095084, 0.000215936521002345, 0.000221665958529974,
			0.000226784527669252, 0.000231248240889671, 0.000235014090293815, 0.000238040258852403,
			0.000240286333932417, 0.000241713522296960, 0.000242284865723817, 0.000241965456360702,
			0.000240722650909088, 0.000238526282705587, 0.000235348870750147, 0.000231165824714202,
			0.000225955644949308, 0.000219700116508094, 0.000212384496184519, 0.000203997691579672,
			0.000194532431202796, 0.000183985424624896, 0.000172357511714387, 0.000159653800000676,
			0.000145883789232598, 0.000131061482224025, 0.000115205481109003, 9.83390681632512e-05,
			8.04902703878009e-05, 6.16919070940166e-05, 4.19816197769953e-05, 2.14018836163928e-05,
			-1.87346740234822e-19, -2.21719304743364e-05, -4.50570549986815e-05, -6.85938359691500e-05,
			-9.27161391550566e-05, -0.000117353342889120, -0.000142430468466854, -0.000167868331862513,
			-0.000193583716785595, -0.000219489569016230, -0.000245495211870058, -0.000271506582553813,
			-0.000297426489082019, -0.000323154887333398, -0.000348589177733021, -0.000373624520953468,
			-0.000398154171935396, -0.000422069831435609, -0.000445262014219172, -0.000467620432921791,
			-0.000489034396519995, -0.000509393222259934, -0.000528586659811412, -0.000546505326332225,
			-0.000563041151049750, -0.000578087827892006, -0.000591541274629877, -0.000603300096925844,
			-0.000613266055623152, -0.000621344535552874, -0.000627445014085407, -0.000631481527607764,
			-0.000633373134068928, -0.000633044369702842, -0.000630425698012585, -0.000625453949080161,
			-0.000618072747254343, -0.000608232925264461, -0.000595892922810859, -0.000581019167693471,
			-0.000563586437558309, -0.000543578200368100, -0.000520986931737601, -0.000495814407316512,
			-0.000468071968453318, -0.000437780759431793, -0.000404971934638251, -0.000369686834091835,
			-0.000331977125852081, -0.000291904913907528, -0.000249542810245946, -0.000204973969910915,
			-0.000158292087960349, -0.000109601357360110, -5.90163869697242e-05, -6.66207890693937e-06,
			4.73265352867950e-05, 0.000102804500117456, 0.000159617183538490, 0.000217600566422777,
			0.000276581574096398, 0.000336378449767734, 0.000396801169526488, 0.000457651898426015,
			0.000518725486999747, 0.000579810007398850, 0.000640687328174275, 0.000701133726562733,
			0.000760920536973294, 0.000819814834210144, 0.000877580149807949, 0.000933977219700128,
			0.000988764761287588, 0.00104170027782691, 0.00109254088791312, 0.00114104417769388, 0.00118696907331928,
			0.00123007673100590, 0.00127013144197516, 0.00130690154941507, 0.00134016037451232, 0.00136968714850789,
			0.00139526794764541, 0.00141669662780701, 0.00143377575556755, 0.00144631753234498, 0.00145414470828206,
			0.00145709148246451, 0.00145500438606125, 0.00144774314496587, 0.00143518151852358, 0.00141720811094582,
			0.00139372715204505, 0.00136465924396516, 0.00132994207063897, 0.00128953106677230, 0.00124340004323567,
			0.00119154176583799, 0.00113396848456284, 0.00107071241046631, 0.00100182613756534, 0.000927383007187891,
			0.000847477412409063, 0.000762225040361889, 0.000671763050386084, 0.000576250186162794,
			0.000475866820177766, 0.000370814929058448, 0.000261317998542189, 0.000147620857051816,
			2.99894370812383e-05, -9.12895361739023e-05, -0.000215908929267415, -0.000343541658119669,
			-0.000473841218638007, -0.000606442289928120, -0.000740961409431809, -0.000876997719073311,
			-0.00101413378124239, -0.00115193646318889, -0.00128995788815139, -0.00142773645129277,
			-0.00156479789826871, -0.00170065646401258, -0.00183481606908293, -0.00196677157068766,
			-0.00209601006527473, -0.00222201223936171, -0.00234425376506855, -0.00246220673661824,
			-0.00257534114388189, -0.00268312637886651, -0.00278503277087791, -0.00288053314593791,
			-0.00296910440589436, -0.00305022912253643, -0.00312339714191533, -0.00318810719397393,
			-0.00324386850250701, -0.00329020239040843, -0.00332664387511245, -0.00335274324910371,
			-0.00336806764035525, -0.00337220254755524, -0.00336475334500267, -0.00334534675208861,
			-0.00331363226233381, -0.00326928352702531, -0.00321199968858364, -0.00314150665889885,
			-0.00305755833799688, -0.00295993776853854, -0.00284845822180985, -0.00272296421103557,
			-0.00258333242803659, -0.00242947259945513, -0.00226132825899035, -0.00207887743231902,
			-0.00188213323162117, -0.00167114435688899, -0.00144599550146622, -0.00120680765954653,
			-0.000953738333649181, -0.000686981640390124, -0.000406768313174500, -0.000113365600750776,
			0.000192922939111974, 0.000511757751236587, 0.000842763700023204, 0.00118553059155805, 0.00153961380026185,
			0.00190453499915929, 0.00227978299251661, 0.00266481464926198, 0.00305905593527354, 0.00346190304229443,
			0.00387272361091363, 0.00429085804473733, 0.00471562091256858, 0.00514630243511501, 0.00558217005245541,
			0.00602247006821795, 0.00646642936615642, 0.00691325719455678, 0.00736214701366593, 0.00781227840110885,
			0.00826281901004885, 0.00871292657465180, 0.00916175095723639, 0.00960843623133246, 0.0100521227947268,
			0.0104919495064521, 0.0109270558415695, 0.0113565840575113, 0.0117796813656839, 0.0121955021019863,
			0.0126032098898760, 0.0130019797896094, 0.0133910004272999, 0.0137694760974767, 0.0141366288328835,
			0.0144917004353342, 0.0148339544615464, 0.0151626781579853, 0.0154771843388969, 0.0157768132018614,
			0.0160609340753778, 0.0163289470931856, 0.0165802847902395, 0.0168144136154873, 0.0170308353568409,
			0.0172290884739977, 0.0174087493350405, 0.0175694333530357, 0.0177107960191520, 0.0178325338291326,
			0.0179343851002827, 0.0180161306764628, 0.0180775945189253, 0.0181186441811778, 0.0181391911664141,
			0.0181391911664141, 0.0181186441811778, 0.0180775945189253, 0.0180161306764628, 0.0179343851002827,
			0.0178325338291326, 0.0177107960191520, 0.0175694333530357, 0.0174087493350405, 0.0172290884739977,
			0.0170308353568409, 0.0168144136154873, 0.0165802847902395, 0.0163289470931856, 0.0160609340753778,
			0.0157768132018614, 0.0154771843388969, 0.0151626781579853, 0.0148339544615464, 0.0144917004353342,
			0.0141366288328835, 0.0137694760974767, 0.0133910004272999, 0.0130019797896094, 0.0126032098898760,
			0.0121955021019863, 0.0117796813656839, 0.0113565840575113, 0.0109270558415695, 0.0104919495064521,
			0.0100521227947268, 0.00960843623133246, 0.00916175095723639, 0.00871292657465180, 0.00826281901004885,
			0.00781227840110885, 0.00736214701366593, 0.00691325719455678, 0.00646642936615642, 0.00602247006821795,
			0.00558217005245541, 0.00514630243511501, 0.00471562091256858, 0.00429085804473733, 0.00387272361091363,
			0.00346190304229443, 0.00305905593527354, 0.00266481464926198, 0.00227978299251661, 0.00190453499915929,
			0.00153961380026185, 0.00118553059155805, 0.000842763700023204, 0.000511757751236587, 0.000192922939111974,
			-0.000113365600750776, -0.000406768313174500, -0.000686981640390124, -0.000953738333649181,
			-0.00120680765954653, -0.00144599550146622, -0.00167114435688899, -0.00188213323162117,
			-0.00207887743231902, -0.00226132825899035, -0.00242947259945513, -0.00258333242803659,
			-0.00272296421103557, -0.00284845822180985, -0.00295993776853854, -0.00305755833799688,
			-0.00314150665889885, -0.00321199968858364, -0.00326928352702531, -0.00331363226233381,
			-0.00334534675208861, -0.00336475334500267, -0.00337220254755524, -0.00336806764035525,
			-0.00335274324910371, -0.00332664387511245, -0.00329020239040843, -0.00324386850250701,
			-0.00318810719397393, -0.00312339714191533, -0.00305022912253643, -0.00296910440589436,
			-0.00288053314593791, -0.00278503277087791, -0.00268312637886651, -0.00257534114388189,
			-0.00246220673661824, -0.00234425376506855, -0.00222201223936171, -0.00209601006527473,
			-0.00196677157068766, -0.00183481606908293, -0.00170065646401258, -0.00156479789826871,
			-0.00142773645129277, -0.00128995788815139, -0.00115193646318889, -0.00101413378124239,
			-0.000876997719073311, -0.000740961409431809, -0.000606442289928120, -0.000473841218638007,
			-0.000343541658119669, -0.000215908929267415, -9.12895361739023e-05, 2.99894370812383e-05,
			0.000147620857051816, 0.000261317998542189, 0.000370814929058448, 0.000475866820177766,
			0.000576250186162794, 0.000671763050386084, 0.000762225040361889, 0.000847477412409063,
			0.000927383007187891, 0.00100182613756534, 0.00107071241046631, 0.00113396848456284, 0.00119154176583799,
			0.00124340004323567, 0.00128953106677230, 0.00132994207063897, 0.00136465924396516, 0.00139372715204505,
			0.00141720811094582, 0.00143518151852358, 0.00144774314496587, 0.00145500438606125, 0.00145709148246451,
			0.00145414470828206, 0.00144631753234498, 0.00143377575556755, 0.00141669662780701, 0.00139526794764541,
			0.00136968714850789, 0.00134016037451232, 0.00130690154941507, 0.00127013144197516, 0.00123007673100590,
			0.00118696907331928, 0.00114104417769388, 0.00109254088791312, 0.00104170027782691, 0.000988764761287588,
			0.000933977219700128, 0.000877580149807949, 0.000819814834210144, 0.000760920536973294,
			0.000701133726562733, 0.000640687328174275, 0.000579810007398850, 0.000518725486999747,
			0.000457651898426015, 0.000396801169526488, 0.000336378449767734, 0.000276581574096398,
			0.000217600566422777, 0.000159617183538490, 0.000102804500117456, 4.73265352867950e-05,
			-6.66207890693937e-06, -5.90163869697242e-05, -0.000109601357360110, -0.000158292087960349,
			-0.000204973969910915, -0.000249542810245946, -0.000291904913907528, -0.000331977125852081,
			-0.000369686834091835, -0.000404971934638251, -0.000437780759431793, -0.000468071968453318,
			-0.000495814407316512, -0.000520986931737601, -0.000543578200368100, -0.000563586437558309,
			-0.000581019167693471, -0.000595892922810859, -0.000608232925264461, -0.000618072747254343,
			-0.000625453949080161, -0.000630425698012585, -0.000633044369702842, -0.000633373134068928,
			-0.000631481527607764, -0.000627445014085407, -0.000621344535552874, -0.000613266055623152,
			-0.000603300096925844, -0.000591541274629877, -0.000578087827892006, -0.000563041151049750,
			-0.000546505326332225, -0.000528586659811412, -0.000509393222259934, -0.000489034396519995,
			-0.000467620432921791, -0.000445262014219172, -0.000422069831435609, -0.000398154171935396,
			-0.000373624520953468, -0.000348589177733021, -0.000323154887333398, -0.000297426489082019,
			-0.000271506582553813, -0.000245495211870058, -0.000219489569016230, -0.000193583716785595,
			-0.000167868331862513, -0.000142430468466854, -0.000117353342889120, -9.27161391550566e-05,
			-6.85938359691500e-05, -4.50570549986815e-05, -2.21719304743364e-05, -1.87346740234822e-19,
			2.14018836163928e-05, 4.19816197769953e-05, 6.16919070940166e-05, 8.04902703878009e-05,
			9.83390681632512e-05, 0.000115205481109003, 0.000131061482224025, 0.000145883789232598,
			0.000159653800000676, 0.000172357511714387, 0.000183985424624896, 0.000194532431202796,
			0.000203997691579672, 0.000212384496184519, 0.000219700116508094, 0.000225955644949308,
			0.000231165824714202, 0.000235348870750147, 0.000238526282705587, 0.000240722650909088,
			0.000241965456360702, 0.000242284865723817, 0.000241713522296960, 0.000240286333932417,
			0.000238040258852403, 0.000235014090293815, 0.000231248240889671, 0.000226784527669252,
			0.000221665958529974, 0.000215936521002345, 0.000209640974095084, 0.000202824643971039,
			0.000195533224165903, 0.000187812581021308, 0.000179708564961776, 0.000171266828201537,
			0.000162532649422522, 0.000153550765919208, 0.000144365213659611, 0.000135019175664793,
			0.000125554839062057, 0.000116013261119668, 0.000106434244523717, 9.68562221108855e-05,
			8.73161512243955e-05, 7.78494178147670e-05, 6.84897503620943e-05, 5.92691436527458e-05,
			5.02177924007311e-05, 4.13640346626618e-05, 3.27343049554072e-05, 2.43530969473100e-05,
			1.62429355573125e-05, 8.42435826167659e-06, 9.15905375230231e-07, -6.26588095666994e-06,
			-1.31064493479167e-05, -1.95932236621213e-05, -2.57155797470351e-05, -3.14648147782411e-05,
			-3.68341095972090e-05, -4.18184844463319e-05, -4.64147485187423e-05, -5.06214437536365e-05,
			-5.44387833184556e-05, -5.78685852276504e-05, -6.09142015539089e-05, -6.35804436916823e-05,
			-6.58735041346801e-05, -6.78008752287559e-05, -6.93712653593427e-05, -7.05945130283952e-05,
			-7.14814992697408e-05, -7.20440588438895e-05, -7.22948906438355e-05, -7.22474677322617e-05,
			-7.19159474179411e-05, -7.13150817651340e-05, -7.04601289144841e-05, -6.93667655774572e-05,
			-6.80510010488354e-05, -6.65290930632939e-05, -6.48174658027601e-05, -6.29326303412047e-05,
			-6.08911077928367e-05, -5.87093554085028e-05, -5.64036958435200e-05, -5.39902497983187e-05,
			-5.14848722112379e-05, -4.89030921607121e-05, -4.62600566120110e-05, -4.35704781217382e-05,
			-4.08485865915686e-05, -3.81080851412770e-05, -3.53621101500907e-05, -3.26231954948451e-05,
			-2.99032409934363e-05, -2.72134850426913e-05, -2.45644814211058e-05, -2.19660802089826e-05,
			-1.94274127613892e-05, -1.69568806531068e-05, -1.45621484994031e-05, -1.22501405420550e-05,
			-1.00270408766353e-05, -7.89829718465892e-06, -5.86862782280389e-06, -3.94203211108448e-06,
			-2.12180365257879e-06, -4.10546509099106e-07, 1.18980594994375e-06, 2.67796971431396e-06,
			4.05328650920915e-06, 5.31569807882518e-06, 6.46571857799615e-06, 7.50440527460958e-06,
			8.43332776645153e-06, 9.25453591612900e-06, 9.97052670678619e-06, 1.05842102195066e-05,
			1.10988749306199e-05, 1.15181525236349e-05, 1.18459824062601e-05, 1.20865761179763e-05,
			1.22443818079481e-05, 1.23240489567487e-05, 1.23303935084684e-05, 1.22683635723364e-05,
			1.21430058450537e-05, 1.19594328966690e-05, 1.17227914540664e-05, 1.14382318070432e-05,
			1.11108784525704e-05, 1.07458020832089e-05, 1.03479930158466e-05, 9.92233614697004e-06,
			9.47358751064512e-06, 9.00635250529271e-06, 8.52506584525360e-06, 8.03397328309023e-06,
			7.53711513860731e-06, 7.03831166073072e-06, 6.54115023870543e-06, 6.04897446958912e-06,
			5.56487507976972e-06, 5.09168268924768e-06, 4.63196239873433e-06, 4.18801017124830e-06,
			3.76185097187243e-06, 3.35523862168689e-06, 2.96965731463963e-06, 2.60632473927529e-06,
			2.26619674083339e-06, 1.94997345326195e-06, 1.65810682518491e-06, 1.39080945882484e-06,
			1.14806467632067e-06, 9.29637723804598e-07, 7.35088020014686e-07, 5.63782353123439e-07,
			4.14908926860107e-07, 2.87492154892933e-07, 1.80408100815630e-07, 9.24004599459233e-08,
			2.20969784866114e-08, -3.19737945852341e-08, -7.13655272565302e-08, -9.76969994672016e-08,
			-1.12634975798380e-07, -1.17877156703393e-07, -1.15135307104001e-07, -1.06118658751313e-07,
			-9.25176799418175e-08, -7.59883029998755e-08, -5.81366964073535e-08, -4.05046645954493e-08,
			-2.45557542337669e-08, -1.16621413750432e-08, -3.09236906250145e-09, 0 };

	/**
	 * Na�o�enie filtru dolnoprzepustowego na podan� tablic� float
	 * 
	 * @param samples
	 *            sygna� do przefiltrowania
	 * @return przefiltrowany sygna� w postaci tablicy float
	 */

	public static float[] filetring(float[] samples) {

		// je�eli sygna� jest zbyt kr�tki do filtrowania
		if (samples.length < coeff.length)
			return null;

		float[] filtered = new float[samples.length + coeff.length];

		// wyliczenie warto�ci dla sampli od 0 do ostatniego sampla
		for (int i = 0; i < samples.length; i++) {
			filtered[i] = 0;
			for (int k = 0; k < coeff.length; k++) {
				filtered[i] += coeff[k] * samples[i - k];
				if (i - k == 0)
					break;
			}
		}

		// pozostaj�ce sample po sko�czeniu sygna�u
		for (int i = samples.length; i < samples.length + coeff.length; i++) {
			filtered[i] = 0;
			for (int k = 0 + (i - samples.length + 1); k < coeff.length; k++) {
				filtered[i] += coeff[k] * samples[i - k];
			}

		}

		// zwr�� przefiltrowany sygna�
		return filtered;
	}
}
